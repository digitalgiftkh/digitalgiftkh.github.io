<!DOCTYPE html>
<html>
<head>
  <title>Google Sheet I/O</title>
</head>
<body>
  <h2>Write to Google Sheet</h2>
  <input type="text" id="name" placeholder="Name">
  <input type="text" id="email" placeholder="Email">
  <button onclick="writeData()">Submit</button>

  <h2>Read from Google Sheet</h2>
  <button onclick="readData()">Load Data</button>
  <div id="output"></div>

  <script>
    const webAppUrl = "https://script.google.com/macros/s/AKfycbyDilzxKKz6pHFUdUkkIHekWMA31EtOeENC_HgnewqGI5UkGlVOy5ztD-xpcapKPivn/exec"; // Replace with your deployed Web App URL

    function writeData() {
      const name = document.getElementById("name").value;
      const email = document.getElementById("email").value;

      fetch(webAppUrl, {
        method: "POST",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded"
        },
        body: `action=write&name=${encodeURIComponent(name)}&email=${encodeURIComponent(email)}`
      })
      .then(res => res.text())
      .then(msg => alert(msg));
    }

    function readData() {
      fetch(webAppUrl + "?action=read")
        .then(res => res.json())
        .then(data => {
          let html = "<table border='1'><tr><th>Name</th><th>Email</th><th>Timestamp</th></tr>";
          for (let i = 1; i < data.length; i++) {
            html += `<tr><td>${data[i][0]}</td><td>${data[i][1]}</td><td>${data[i][2]}</td></tr>`;
          }
          html += "</table>";
          document.getElementById("output").innerHTML = html;
        });
    }
  </script>
</body>
</html>
